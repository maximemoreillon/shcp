<!-- views/index.ejs -->
<!DOCTYPE html>
<html lang="en">
<head>
  <% include partials/head %>

  <link rel="stylesheet" type="text/css" href="css/show_devices.css">


</head>
<body>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.3/socket.io.js"></script> <!-- include socket.io client side script -->

  <script>
  var socket = io();
  </script>

  <div class="wrapper">

    <header>
      <% include partials/header %>
    </header>

    <main>

      <div id="floorplan_wrapper" class="floorplan_wrapper">
        <img id="floorplan" class="floorplan" src="images/floorplan.svg">

        <% devices.forEach(function(device) { %>
          <div
          class="device_wrapper"
          style=" left: <%=device.position_x%>%; top: <%=device.position_y%>%;">
            <img
            class="device_image"
            id='<%=device.status_topic%>'
            onclick="socket.emit('switch',{topic: '<%=device.command_topic%>', payload:'TOGGLE'})"
            src="<%=device.image%>">
          </div>
        <%} );%>

      </div>

      <form action="manage_devices" >
        <input type="submit" value="Mange entities">
      </form>


    </main>

    <footer>
      <% include partials/footer %>
    </footer>

  </div> <!-- End of wrapper -->

  <!-- Modal for connection -->
  <div id="myModal" class="modal">
    <!-- Modal content -->
    <div class="modal-content">
      NO CONNECTION
    </div>
  </div>

  <script src="js/incoming_websocket_message.js"></script>
  <script src="js/no_connection_modal.js"></script>

</body>
</html>
